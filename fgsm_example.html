<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FGSM Python Example</title>

     <!-- link tag for bstrp-->
     <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <link href="../Capstone Project 1/capstone_css.css" rel ="stylesheet">
     <!--link to the index css for the top nav bar css-->
     <!-- <link rel="stylesheet" href="../HomePage/main_css.css"> -->
</head>
<body>

<!--Navigation bar-->
    <nav class="navbar navbar-expand-lg bg-body-tertiary" data-bs-theme="dark">
        <div class="container-fluid">
          <a class="navbar-brand" href="#">
            <img src="../HomePage/Black Grey Simple Initial Logo.png" alt="Bootstrap" width="50" height="50">
        </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
              <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="../HomePage/main_html.html">Home</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="../Capstone Project 1/capstone_project.html">Capstone Project</a>
              </li>

               <!-- Drop down Menu for Games-->
              <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                  Games
                </a>
                <ul class="dropdown-menu">
                  <li><a class="dropdown-item" href="../whack_a_mole/Index.html">Whack A Mole</a></li>
                  <li><a class="dropdown-item" href="../SimpleGame/Index.html"> Ball Defence</a></li>
                  <li><a class="dropdown-item" href="#"> Tic Tac Toe</a></li>
                  <li><hr class="dropdown-divider"></li>
                  <li><a class="dropdown-item" href="#"> Game Notes</a></li>
                </ul>
              </li>

              <!-- Drop down Menu for Page examples-->
              <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                  Example Pages
                </a>
                <ul class="dropdown-menu">
                  <li><a class="dropdown-item" href="../project_one_simple_tutorial/index.html">Bouncing Balls</a></li>
                  <li><a class="dropdown-item" href="../SimpleGame/Index.html"> Store Page </a></li>
                  <li><hr class="dropdown-divider"></li>
                  <li><a class="dropdown-item" href="#"> Game Notes</a></li>
                </ul>
              </li>

             <!-- Drop down Menu for Scripts and Functions-->
             <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                  Scripts and Functions
                </a>
                <ul class="dropdown-menu">
                  <li><a class="dropdown-item" href="#">Random Colour Picker</a></li>
                  <li><a class="dropdown-item" href="#"> Card Shuffler </a></li>
                </ul>
              </li>



              <!-- <li class="nav-item">
                <a class="nav-link disabled" aria-disabled="true">Disabled</a>
              </li> -->
              <li class="nav-item">
                <a class="nav-link" href="#">About</a>
              </li>

              <li class="nav-item">
                <a class="nav-link" href="#">Contact</a>
              </li>


            </ul>
            <form class="d-flex" role="search">
              <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
              <button class="btn btn-outline-success" type="submit">Search</button>
            </form>
          </div>
        </div>
      </nav>
    


    <div class = "center_container">
    <h2> FGSM Python Example</h2>
    <p> The following example of the Fast sign gradient method using tensorflow is taken from the teh tensorflow <a href="#" >website</a>, a more detailed description of
    the project and its implementation can be seen there.</p>
    
    <!-- The example-->
    <div>
        Example of FGSM using tensorflow.

Firstly the relevant libraries are imported: <br><br>

<img src="../Capstone Project 1/1.PNG"><br>

Tensor flow is a widely known library for building and training deep learning models. 
Matplotlib is a library for data visualisation, the pyplot module from the matplotlib is use for data vs in python<br><br>

The parameters are set according to the following:<br>
<img src="../Capstone Project 1/2.PNG"><br>


This is simply to control the visualisation of the image to the screen so we can see what we are looking at clearly and doesn't effect the FSGM process itself.<br><br>


Next the pretrained model is loaded:<br>
<img src="../Capstone Project 1/3.PNG"><br>

MobileNetV2 is a pre trained deep learning model.<br>
ImageNet Weight are learned parameters from over 1million images and over 1000 categories. The “ImageNet” weights are reference to the training that the model has already undertaken. 
The pretrained_model.trainable = False is to prevent the weight from being updated during any further training as this is not required for the FSGM process<br><br>

<img src="../Capstone Project 1/4.PNG"><br>

This decode prediction variable essentially maps the output from the model to a list of labels that we can read from the ImageNet dataset.<br><br>

Next the image is prepared for the MobileNetV2 model- the model requires the image to be a certain format for processing:<br>
The first steps casts a tensor of the image to a float32 tensor datatype<br>
Next the image is resized to be used by the model<br>
Finally the preprocess function of the mobile net model is called to further prepare the image.<br><br>
<img src="../Capstone Project 1/5.PNG"><br>


The get_imagenet_label is used to get a label for the image.The model will return a vector of probabilities eg (0.001, 0.07, 0.002, ..) -
 Note for Mobilenetv2 with 1000 categories, the array will have 1000 values. This function calls the previously defined decode predictions to turn this into labels, 
 returns the ‘top=1’ eg the highest prediction and accesses the [0][0] first and only images top prediction.<br><br>

 <img src="../Capstone Project 1/6.PNG"><br>




Next the image of a labrador is accessed:<br><br>

<img src="../Capstone Project 1/7.PNG"><br>

This image data is read into memory by the script, then passed into the the preprocess function declared above so that it is a format ready to be read by the script<br>


After this the image is passed into the pretrained model for a prediction. The matplotlib module is then used to display this on screen with the label and confidence score.<br>

<img src="../Capstone Project 1/8.PNG"><br>


Next the loss is calculated as we now know the model's prediction, and the correct value. The tf.keras.lossese module from tensorflow is used to access the CategoricalCrossentropy() function.<br>
<img src="../Capstone Project 1/9.PNG"><br>
 The logic here is handle by the tensor flow library, however it should be noted that cross entropy is  a mathematical concept that measure the difference between two probability distributions.<br><br>

The Gradient aspect of the FGSM is executed.<br>
The GradientTape() is used to compute the gradient of the loss with respect to the input image. These gradients are then used to create adversarial perturbations.<br>
tape.watch(input_image) tells the GradientTape to keep track of the input_image so that gradients can be computed with respect to it. By default, GradientTape only watches trainable variables,
 so non-trainable variables (like the input image) need to be explicitly watched<br><br>
 <img src="../Capstone Project 1/10.PNG"><br>
The tf.sign() function takes the gradient and converts it into a sign map, where each value is either -1, 0, or 1, depending on the sign of the corresponding gradient value.<br>
This step simplifies the gradient map into a directional map that indicates whether to increase or decrease each pixel value to maximize the loss.<br>
This is the adversarial gradient map, which is then used to create perturbations that slightly modify the original image.<br><br>

<img src="../Capstone Project 1/12.PNG"><br>



The perturbations are calculated by the previously mentioned function<br>

perturbations = create_adversarial_pattern(image, label)<br>
<img src="../Capstone Project 1/11.PNG"><br>



Next several epsilons values are provided to be able to visually see the effect of increasing the magnitude of disturbance/noise ,these are then displayed to the screen<br><br>
<img src="../Capstone Project 1/14.PNG"><br>


    </div>

    </div>

      
    <!--script tag for bstrp-->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

</body>
</html>